<article class="product-card">
  <!-- Image Gallery -->
  <div class="card-image-wrapper">
    <div class="card-main-image-wrapper">
      <img
        [src]="product.images[activeImageIndex]"
        [alt]="product.name"
        class="card-main-image"
      />
    </div>
    <div class="image-thumbnails" *ngIf="product.images.length > 1">
      <button
        *ngFor="let img of product.images; let i = index"
        class="thumb-btn"
        [class.active]="i === activeImageIndex"
        (click)="selectImage(i)"
      >
        <img [src]="img" [alt]="product.name + ' image ' + (i + 1)" />
      </button>
    </div>
  </div>

  <!-- Card Body -->
  <div class="card-body">
    <h3 class="card-title">{{ product.name }}</h3>

    <p class="card-description">{{ product.description }}</p>

    <!-- Rating -->
    <div class="card-rating">
      <span
        *ngFor="let star of stars"
        class="star"
        [class.filled]="isStarFilled(star)"
        [class.half]="isStarHalf(star)"
      >â˜…</span>
      <span class="rating-value">{{ product.rating }}</span>
    </div>

    <!-- Price & Share -->
    <div class="card-footer">
      <span class="card-price">{{ formatPrice(product.price) }}</span>

      <div class="share-wrapper">
          <button class="share-btn" (click)="toggleShareMenu(); $event.stopPropagation()">
          <span>Share</span>
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/></svg>
        </button>
        <div class="share-menu" *ngIf="showShareMenu">
          <button class="share-option kaspi" (click)="openOnKaspi()">
            ðŸ›’ ÐžÑ‚ÐºÑ€Ñ‹Ñ‚ÑŒ Ð½Ð° Kaspi
          </button>
          <button class="share-option whatsapp" (click)="shareOnWhatsApp()">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51a12.8 12.8 0 0 0-.57-.01c-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347z"/><path d="M11.999 2C6.476 2 2 6.476 2 12.001c0 1.788.473 3.491 1.371 4.979L2 22l5.09-1.336A9.928 9.928 0 0 0 12 22c5.523 0 10-4.477 10-10S17.523 2 12 2h-.001z" fill="none" stroke="currentColor" stroke-width="1.5"/></svg>
            WhatsApp
          </button>
          <button class="share-option telegram" (click)="shareOnTelegram()">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm5.562 8.248-1.97 9.28c-.145.658-.537.818-1.084.508l-3-2.21-1.447 1.394c-.16.16-.295.295-.605.295l.213-3.053 5.56-5.023c.242-.213-.054-.333-.373-.12l-6.871 4.326-2.962-.924c-.643-.204-.657-.643.136-.953l11.57-4.461c.537-.194 1.006.131.833.941z"/></svg>
            Telegram
          </button>
        </div>
      </div>
    </div>
  </div>
</article>
